// Generated by CoffeeScript 1.8.0
angular.module('Sonnets').directive('annotate', function() {
  return {
    scope: {
      lineNumber: '@'
    },
    link: function($scope, el, attrs) {
      return el.bind('click', function() {
        var lineNumber, selection;
        lineNumber = angular.element(window.getSelection().baseNode.parentElement)[0].getAttribute('line-number');
        selection = window.getSelection().toString();
        if (selection !== "") {
          return $scope.$apply(function() {
            $scope.$parent.showPanel = true;
            return $scope.$parent.annotation = {
              quote: selection,
              lineNumber: lineNumber
            };
          });
        }
      });
    }
  };
});
